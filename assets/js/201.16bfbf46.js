(window.webpackJsonp=window.webpackJsonp||[]).push([[201],{527:function(t,e,r){"use strict";r.r(e);var a=r(7),_=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h3",{attrs:{id:"热备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#热备份"}},[t._v("#")]),t._v(" 热备份")]),t._v(" "),e("p",[t._v("与冷备份正好相反，热备份是在数据库处于运行状态时直接备份，不影响现有业务的正常进行。热备份又细分为逻辑备份和裸文件备份，下面我们介绍逻辑备份和冷备份以及它们常用的备份和恢复的方法。")]),t._v(" "),e("h2",{attrs:{id:"逻辑备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#逻辑备份"}},[t._v("#")]),t._v(" 逻辑备份")]),t._v(" "),e("p",[t._v("逻辑备份的最大优点就是对于各种存储引擎，都可以用同样的方法来备份。而冷备份则不同，不同的存储引擎的备份方法也各不相同。因此，对于不同存储引擎混合的数据库，用逻辑备份会更简单一些。")]),t._v(" "),e("p",[t._v("逻辑备份可以说是最简单，也是目前中小型系统最常用的备份方法。逻辑备份主要有以下几种方法：")]),t._v(" "),e("h4",{attrs:{id:"_1-mysqldump"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-mysqldump"}},[t._v("#")]),t._v(" 1）mysqldump")]),t._v(" "),e("p",[t._v("mysqldump 是 MySQL 自带的逻辑备份工具。它的备份原理是通过协议连接到 MySQL 数据库，将需要备份的数据查询出来，然后将查询出的数据转换成对应的 INSERT 语句。当我们需要还原恢复这些数据时，只要执行这些 INSERT 语句，就能将对应的数据还原。所以有的资料也将这种备份方式称为 INSERT 备份。")]),t._v(" "),e("p",[t._v("恢复数据时可以使用 "),e("code",[t._v("mysql -uroot -p <backup.sql")]),t._v(" 直接调用备份文件执行所有命令，将数据完全恢复到备份时候的状态。如果已经连接上了 MySQL 服务器，那么可以通过 "),e("code",[t._v("source /path/backup.sql")]),t._v(" 来进行恢复。")]),t._v(" "),e("blockquote",[e("p",[t._v("我们在《"),e("a",{attrs:{href:"http://c.biancheng.net/view/7373.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL mysqldump备份数据库"),e("OutboundLink")],1),t._v("》和《"),e("a",{attrs:{href:"http://c.biancheng.net/view/7381.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL恢复数据库"),e("OutboundLink")],1),t._v("》中详细介绍了上面所讲的备份和恢复数据的方法。")])]),t._v(" "),e("h4",{attrs:{id:"_2-select-into-outfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-select-into-outfile"}},[t._v("#")]),t._v(" 2）SELECT INTO…OUTFILE")]),t._v(" "),e("p",[t._v("SELECT INTO…OUTFILE 语句可以把表数据导出到一个文本文件中，且能将数据库中的表数据以特定分隔符进行分隔后记录在文本文件中，以达到逻辑备份的效果。")]),t._v(" "),e("p",[t._v("这种备份方式与 mysqldump 方法相比，使用的存储空间更小，数据格式更加清晰明确，编辑方便。但是这种方法只能导出或导入数据的内容，不包括表的结构，如果表的结构文件损坏，则必须先恢复原来的表的结构。而且这种方法不能在同一个备份文件中存在多个表的备份数据，增加了文件维护和恢复的成本。")]),t._v(" "),e("p",[t._v("这种备份方法恢复起来会稍微麻烦一点，需要一个表一个表通过相关命令来进行恢复。当然如果是通过脚本来实现自动多表恢复也是比较方便的。恢复方法有 2 个，一个是通过 MySQL 的 LOAD DATA INFILE 命令来恢复数据，另一种方法就是通过 MySQL 提供的使用工具 mysqlimport 来进行恢复。")]),t._v(" "),e("blockquote",[e("p",[t._v("我们在《"),e("a",{attrs:{href:"http://c.biancheng.net/view/7378.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL导出表数据"),e("OutboundLink")],1),t._v("》和《"),e("a",{attrs:{href:"http://c.biancheng.net/view/2623.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL数据库恢复（LOAD DATA）"),e("OutboundLink")],1),t._v("》中详细介绍了上面所讲的备份和恢复数据的方法。")])]),t._v(" "),e("h4",{attrs:{id:"_3-mydumper"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-mydumper"}},[t._v("#")]),t._v(" 3）mydumper")]),t._v(" "),e("p",[t._v("mydumper 是针对 MySQL 数据库备份的一个轻量级第三方的开源工具，备份方式为逻辑备份。它支持多线程，备份速度远高于原生态的 mysqldump 以及其它众多优异特性。与其配套的相应恢复数据为 myloader 工具。DBA 称 mydumper 和 myloader 为备份界的“小钢炮”。")]),t._v(" "),e("p",[t._v("我们可以看出所谓的逻辑备份就是备份 SQL 语句，然后恢复数据时执行备份 SQL，从而实现数据库数据的重现。逻辑备份完成后所形成的文件都可以直接编辑。")]),t._v(" "),e("p",[t._v("逻辑备份的作用如下：")]),t._v(" "),e("ul",[e("li",[t._v("通过逻辑备份，我们可以仅仅恢复备份中的部分数据而不需要全部恢复。不会影响不相关的数据；")]),t._v(" "),e("li",[t._v("通过全库的逻辑备份，我们可以在新的 MySQL 环境下完全重建出一个与备份时完全一样的数据库，并且不受平台类型限制；")]),t._v(" "),e("li",[t._v("通过特定条件的逻辑备份，我们可以将某些特定数据轻松迁移（或者同步）到其它的 MySQL 或另外的数据库环境。")])]),t._v(" "),e("h2",{attrs:{id:"裸文件备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#裸文件备份"}},[t._v("#")]),t._v(" 裸文件备份")]),t._v(" "),e("p",[t._v("裸文件备份主要在底层复制数据文件，所以备份速度要比逻辑备份更快。")]),t._v(" "),e("p",[t._v("我们利用 Percona 公司发布的一个 XtraBackup 热备份工具来完成裸文件备份，它是 Percona 公司的开源项目，据官方介绍它是世界上唯一 一款开源的能够对 InnoDB 和 XtraDB 数据库进行热备的工具。")]),t._v(" "),e("p",[t._v("它的优点就是备份与恢复过程的速度很快，安全可靠，而且在备份过程中不会缩表，不影响现有业务。但它目前还是不能对表结构文件和其它非事务类型的表进行备份。")])])}),[],!1,null,null,null);e.default=_.exports}}]);