(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{534:function(r,e,o){"use strict";o.r(e);var t=o(7),a=Object(t.a)({},(function(){var r=this,e=r._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("h1",{attrs:{id:"mysql错误日志-error-log-详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql错误日志-error-log-详解"}},[r._v("#")]),r._v(" MySQL错误日志（Error Log）详解")]),r._v(" "),e("p",[r._v("错误日志（Error Log）是 MySQL 中最常用的一种日志，主要记录 MySQL 服务器启动和停止过程中的信息、服务器在运行过程中发生的故障和异常情况等。")]),r._v(" "),e("p",[r._v("作为初学者，要学会利用错误日志来定位问题。下面介绍如何操作查看错误日志。")]),r._v(" "),e("h2",{attrs:{id:"启动和设置错误日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动和设置错误日志"}},[r._v("#")]),r._v(" 启动和设置错误日志")]),r._v(" "),e("p",[r._v("在 MySQL 数据库中，默认开启错误日志功能。一般情况下，错误日志存储在 MySQL 数据库的数据文件夹下，通常名称为 hostname.err。其中，hostname 表示 MySQL 服务器的主机名。")]),r._v(" "),e("p",[r._v("在 MySQL 配置文件中，错误日志所记录的信息可以通过 log-error 和 log-warnings 来定义，其中，log-err 定义是否启用错误日志功能和错误日志的存储位置，log-warnings 定义是否将警告信息也记录到错误日志中。")]),r._v(" "),e("p",[r._v("将 log_error 选项加入到 MySQL 配置文件的 [mysqld] 组中，形式如下：")]),r._v(" "),e("p",[r._v("[mysqld]"),e("br"),r._v("\nlog-error=dir/{filename}")]),r._v(" "),e("p",[r._v("其中，dir 参数指定错误日志的存储路径；filename 参数指定错误日志的文件名；省略参数时文件名默认为主机名，存放在 Data 目录中。")]),r._v(" "),e("p",[r._v("重启 MySQL 服务后，参数开始生效，可以在指定路径下看到 filename.err 的文件，如果没有指定 filename，那么错误日志将直接默认为 hostname.err。")]),r._v(" "),e("blockquote",[e("p",[r._v("注意：错误日志中记录的并非全是错误信息，例如 MySQL 如何启动 InnoDB 的表空间文件、如何初始化自己的存储引擎等，这些也记录在错误日志文件中。")])]),r._v(" "),e("h2",{attrs:{id:"查看错误日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看错误日志"}},[r._v("#")]),r._v(" 查看错误日志")]),r._v(" "),e("p",[r._v("错误日志中记录着开启和关闭 MySQL 服务的时间，以及服务运行过程中出现哪些异常等信息。如果 MySQL 服务出现异常，可以到错误日志中查找原因。")]),r._v(" "),e("p",[r._v("在 MySQL 中，通过 SHOW 命令可以查看错误日志文件所在的目录及文件名信息。")]),r._v(" "),e("p",[r._v("mysql> SHOW VARIABLES LIKE 'log_error';\n+---------------+----------------------------------------------------------------+\n| Variable_name | Value                                                          |\n+---------------+----------------------------------------------------------------+\n| log_error     | C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Data\\LAPTOP-UHQ6V8KP.err |\n+---------------+----------------------------------------------------------------+\n1 row in set, 1 warning (0.04 sec)")]),r._v(" "),e("p",[r._v("错误日志以文本文件的形式存储，直接使用普通文本工具就可以查看。这里通过记事本打开，从上面可以知道错误日志的文件名。该文件在默认的数据路径“C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Data\\”下，打开 LAPTOP-UHQ6V8KP.err 文件，部分内容如下：")]),r._v(" "),e("p",[r._v("190906 22:06:45 InnoDB: Completed initialization of buffer pool"),e("br"),r._v("\n190906 22:06:45 InnoDB: highest supported file format is Barracuda."),e("br"),r._v("\n190906 22:06:45  InnoDB: Waiting for the background threads to start"),e("br"),r._v("\n190906 22:06:46 InnoDB: 5.7.29 started; log sequence number 1605345"),e("br"),r._v("\n190906 22:06:47 [Note] Server hostname (bind-address): '0.0.0.0'; port: 3306"),e("br"),r._v("\n190906 22:06:47 [Note]   - '0.0.0.0' resolves to '0.0.0.0';"),e("br"),r._v("\n190906 22:06:47 [Note] Server socket created on IP: '0.0.0.0'."),e("br"),r._v("\n190906 22:06:47 [Note] Event Scheduler: Loaded 0 events"),e("br"),r._v("\n190906 22:06:47 [Note] /usr/sbin/mysqld: ready for connections."),e("br"),r._v("\nVersion: '5.7.29-log'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  MySQL Community Server (GPL)")]),r._v(" "),e("p",[r._v("以上是错误日志文件的一部分，主要记载了系统的一些运行错误。")]),r._v(" "),e("h2",{attrs:{id:"删除错误日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除错误日志"}},[r._v("#")]),r._v(" 删除错误日志")]),r._v(" "),e("p",[r._v("在 MySQL 中，可以使用 mysqladmin 命令来开启新的错误日志，以保证 MySQL 服务器上的硬盘空间。mysqladmin 命令的语法如下：")]),r._v(" "),e("p",[r._v("mysqladmin -uroot -p flush-logs")]),r._v(" "),e("p",[r._v("执行该命令后，MySQL 服务器首先会自动创建一个新的错误日志，然后将旧的错误日志更名为 filename.err-old。")]),r._v(" "),e("p",[r._v("MySQL 服务器发生异常时，管理员可以在错误日志中找到发生异常的时间、原因，然后根据这些信息来解决异常。对于很久之前的错误日志，查看的可能性不大，可以直接将这些错误日志删除。")])])}),[],!1,null,null,null);e.default=a.exports}}]);