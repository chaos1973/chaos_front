(window.webpackJsonp=window.webpackJsonp||[]).push([[215],{541:function(t,_,e){"use strict";e.r(_);var v=e(7),s=Object(v.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"mysql如何分析查询语句"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mysql如何分析查询语句"}},[t._v("#")]),t._v(" MySQL如何分析查询语句？")]),t._v(" "),_("p",[t._v("查询是数据库中最频繁的操作，提高查询速度可以有效的提高 MySQL 数据库的性能。在《"),_("a",{attrs:{href:"http://c.biancheng.net/view/vip_8367.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何定位效率低下的SQL语句"),_("OutboundLink")],1),t._v("》一节我们了解了如何查询效率低下的 SQL 语句，本节主要介绍如何分析查询语句。")]),t._v(" "),_("p",[t._v("通过对查询语句的分析，可以了解查询语句的执行情况，找出查询语句执行的瓶颈，从而优化查询语句。在 MySQL 中，可以使用 EXPLAIN 和 DESCRIBE 获取 MySQL 执行 SELECT 语句的信息，来分析查询语句。")]),t._v(" "),_("p",[_("strong",[t._v("EXPLAIN")]),t._v(" 语句的基本语法如下：")]),t._v(" "),_("p",[t._v("EXPLAIN SELECT 语句;")]),t._v(" "),_("p",[t._v("“SELECT 语句”参数一般为数据库查询命令，如“SELECT * FROM tb_student”。通过 EXPLAIN 关键字可以分析后面 SELECT 语句的执行情况，并且能够分析出所查询表的一些内容。")]),t._v(" "),_("h4",{attrs:{id:"例-1"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#例-1"}},[t._v("#")]),t._v(" 例 1")]),t._v(" "),_("p",[t._v("下面使用 EXPLAIN 语句来分析一个查询语句。代码执行如下：")]),t._v(" "),_("p",[t._v("mysql> EXPLAIN SELECT * FROM tb_student \\G\n*************************** 1. row ***************************\nid: 1\nselect_type: SIMPLE\ntable: tb_student\npartitions: NULL\ntype: ALL\npossible_keys: NULL\nkey: NULL\nkey_len: NULL\nref: NULL\nrows: 7\nfiltered: 100.00\nExtra: NULL\n1 row in set, 1 warning (0.01 sec)")]),t._v(" "),_("p",[t._v("对以上结果中参数说明如下：")]),t._v(" "),_("h4",{attrs:{id:"_1-id"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-id"}},[t._v("#")]),t._v(" 1）id")]),t._v(" "),_("p",[t._v("表示 SELECT 语句的编号，也就是在整个查询中 SELECT 的位置。如果在语句中没子查询或关联查询，只有唯一的 SELECT，每行都将显示 1。否则，内层的 SELECT 语句一般会顺序编号，对应于其在原始语句中的位置。")]),t._v(" "),_("h4",{attrs:{id:"_2-select-type"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-select-type"}},[t._v("#")]),t._v(" 2）select_type")]),t._v(" "),_("p",[t._v("表示 SELECT 语句的类型，该参数有以下几个常用的取值：")]),t._v(" "),_("ul",[_("li",[t._v("SIMPLE：表示简单查询，其中不包括连接查询和子查询；")]),t._v(" "),_("li",[t._v("PRIMARY：表示主查询，或者是最外层的查询语句；")]),t._v(" "),_("li",[t._v("UNION：表示连接查询的第二个或后面的查询语句；")]),t._v(" "),_("li",[t._v("DEPENDENT UNION：连接查询中的第 2 个或后面的 SELECT 语句，取决于外面的查询；")]),t._v(" "),_("li",[t._v("UNION RESULT：连接查询的结果；")]),t._v(" "),_("li",[t._v("SUBQUERY：子查询中的第 1 个 SELECT 语句；")]),t._v(" "),_("li",[t._v("DEPENDENT SUBQUERY：子查询中的第 1 个 SELECT 语句，取决于外面的查询；")]),t._v(" "),_("li",[t._v("DERIVED：导出表的 SELECT（FROM 子句的子查询）。")])]),t._v(" "),_("h4",{attrs:{id:"_4-table"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-table"}},[t._v("#")]),t._v(" 4）table")]),t._v(" "),_("p",[t._v("表示查询的表；")]),t._v(" "),_("h4",{attrs:{id:"_5-type"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-type"}},[t._v("#")]),t._v(" 5）type")]),t._v(" "),_("p",[t._v("表示表的连接类型。该参数有以下几个常用的取值，范围从 NULL 到 ALL。下面按照最佳类型到最差类型排序：")]),t._v(" "),_("ul",[_("li",[t._v("NULL：不用访问表或者索引，直接就能得到结果；")]),t._v(" "),_("li",[t._v("system：表示表中只有一条记录；")]),t._v(" "),_("li",[t._v("const：表示表中有多条记录，但只从表中查询一条记录；")]),t._v(" "),_("li",[t._v("eq _ref：类似 ref，表示多表连接时，后面的表使用了 UNIQUE 或者 PRIMARY KEY；")]),t._v(" "),_("li",[t._v("ref：表示多表查询时，后面的表使用了普通索引；")]),t._v(" "),_("li",[t._v("range：表示查询语句中给出了查询范围，常见于 <、<=、>、>=、between 等操作符；")]),t._v(" "),_("li",[t._v("index：表示对表中的索引进行了完整的扫描，MySQL 遍历整个索引来查询匹配的行；")]),t._v(" "),_("li",[t._v("ALL：表示对表进行了完整的扫描，MySQL 遍历全表来找到匹配的行。")])]),t._v(" "),_("h4",{attrs:{id:"_6-possible-keys"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_6-possible-keys"}},[t._v("#")]),t._v(" 6）possible_keys")]),t._v(" "),_("p",[t._v("表示查询中可以使用的索引；")]),t._v(" "),_("h4",{attrs:{id:"_7-key"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_7-key"}},[t._v("#")]),t._v(" 7）key")]),t._v(" "),_("p",[t._v("表示实际查询中使用到的索引；")]),t._v(" "),_("h4",{attrs:{id:"_8-key-len"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_8-key-len"}},[t._v("#")]),t._v(" 8）key_len")]),t._v(" "),_("p",[t._v("表示索引字段的长度；")]),t._v(" "),_("h4",{attrs:{id:"_9-ref"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_9-ref"}},[t._v("#")]),t._v(" 9）ref")]),t._v(" "),_("p",[t._v("表示使用哪个列或常数与索引一起来查询记录；")]),t._v(" "),_("h4",{attrs:{id:"_10-rows"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_10-rows"}},[t._v("#")]),t._v(" 10）rows")]),t._v(" "),_("p",[t._v("表示查询的行数；")]),t._v(" "),_("h4",{attrs:{id:"_11-filtered"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_11-filtered"}},[t._v("#")]),t._v(" 11）filtered")]),t._v(" "),_("p",[t._v("MySQL 5.7 版本之前使用 EXPLAIN EXTENDED 时会出现这个字段，MySQL 5.7 版本之后包括 5.7 版本默认就有这个字段。这个字段表示存储引擎返回的数据在 server 层过滤后，剩下多少满足查询记录数量的比例。注意是百分比，不是具体记录数。")]),t._v(" "),_("h4",{attrs:{id:"_12-extra"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_12-extra"}},[t._v("#")]),t._v(" 12）Extra")]),t._v(" "),_("p",[t._v("表示查询过程的附件信息。")]),t._v(" "),_("p",[_("strong",[t._v("DESCRIBE")]),t._v(" 语句的使用方法与 EXPLAIN 语句一样，DESCRIBE 语句的语法形式如下：")]),t._v(" "),_("p",[t._v("DESCRIBE SELECT语句；")]),t._v(" "),_("p",[t._v("DESCRIBE 可以缩写成 DESC。")]),t._v(" "),_("h4",{attrs:{id:"例-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#例-2"}},[t._v("#")]),t._v(" 例 2")]),t._v(" "),_("p",[t._v("下面使用 DESCRIBE 语句来分析一个查询语句。代码执行如下：")]),t._v(" "),_("p",[t._v("mysql> DESCRIBE SELECT * FROM tb_student \\G\n*************************** 1. row ***************************\nid: 1\nselect_type: SIMPLE\ntable: tb_student\npartitions: NULL\ntype: ALL\npossible_keys: NULL\nkey: NULL\nkey_len: NULL\nref: NULL\nrows: 7\nfiltered: 100.00\nExtra: NULL\n1 row in set, 1 warning (0.00 sec)")]),t._v(" "),_("p",[t._v("可以看出，以上运行结果与例 1 基本相同，这里不再对上述参数进行说明，参考例 1 即可。")])])}),[],!1,null,null,null);_.default=s.exports}}]);