---
title: Hyper-V设置虚拟机固定Ip的方法步骤
date: 2023-02-17 17:25:28
permalink: /pages/2df9ec/
categories:
  - Linux
tags:
  - 
author: 
  name: ~chao
  link: https://github.com/chaos1973/chaos_front
---
# Hyper-V设置虚拟机固定Ip的方法步骤

原文链接：[Hyper-V设置虚拟机固定Ip的方法步骤_Hyper-V_脚本之家 (jb51.net)](https://www.jb51.net/article/252606.htm)

本文主要介绍了Hyper-V设置虚拟机固定Ip的方法步骤，文中通过示例代码介绍的非常详细，对大家的学习或者工作具有一定的参考学习价值，需要的朋友们下面随着小编来一起学习学习吧  

(adsbygoogle = window.adsbygoogle || \[\]).push({});

win10下使用hyper-v在本机安装linux虚拟机后，网络访问上有如下两点需求：

（1）无论物理机的网络环境怎么变化，都需要保持虚拟机的IP地址不变，保证我本机使用xshell等终端访问始终用同一个IP地址，或者在安装了其他软件后，访问虚拟机的IP地址保持不变。

（2）物理机可访问虚拟机，虚拟机是否可访问网络都行。重点保证本机可访问虚拟机，以及虚拟机之间能互相访问。

1、为了实现第一点，需给虚拟机设置一个固定的网段以及静态IP，这里使用192.168.137.X的网段，如下以centos7操作系统为例子，实现静态IP的设置：

[?](https://www.jb51.net/article/252606.htm#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash functions">cd</code> <code class="bash plain">/etc/sysconfig/network-scripts</code></div><div class="line number2 index1 alt1"><code class="bash functions">vi</code> <code class="bash plain">ifcfg-eth0</code></div></div></td></tr></tbody></table>

主要修改如下信息，这里我设置静态IP地址为192.168.137.200

[?](https://www.jb51.net/article/252606.htm#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">BOOTPROTO=static</code></div><div class="line number2 index1 alt1"><code class="plain plain">DEVICE=eth0</code></div><div class="line number3 index2 alt2"><code class="plain plain">ONBOOT=yes</code></div><div class="line number4 index3 alt1"><code class="plain plain">IPADDR=192.168.137.200</code></div><div class="line number5 index4 alt2"><code class="plain plain">GATEWAY=192.168.137.1</code></div><div class="line number6 index5 alt1"><code class="plain plain">DNS1=192.168.137.1</code></div><div class="line number7 index6 alt2"><code class="plain plain">NETMASK=255.255.255.0</code></div></div></td></tr></tbody></table>

重启网络服务，使设置生效：  
systemctl restart network

2、Hyper-V上面的虚拟网络设置

打开Hyper-V上的虚拟机交换机管理器：

![](//img.jbzj.com/file_images/article/202206/20220622153220104.jpg)

新建虚拟网络交换机，输入名称，选择内部网络，点击确定：

![](//img.jbzj.com/file_images/article/202206/20220622153220105.jpg)

右键选中需要设置的虚拟机的设置选项，弹出如下框，选择刚才新建的Centos-7的虚拟交换机，点击确定，之后便可重启虚拟机使之生效：

![](//img.jbzj.com/file_images/article/202206/20220622153221106.jpg)

3、物理机上面的网络设置，我本机使用的是win10，打开控制面板->网络和共享中心->更改适配器设置：

找到刚刚在hyper-v上新增的虚拟网络交换机，右键选择属性：

![](//img.jbzj.com/file_images/article/202206/20220622153221107.jpg)

选择如下IPv4协议：

![](//img.jbzj.com/file_images/article/202206/20220622153221108.jpg)

设置如下IP地址和子网掩码，其他可留空，IP地址必须是192.168.X.1的设置，这里的X=137是刚才我们在centos7上设置的网段，需保持一致：

![](//img.jbzj.com/file_images/article/202206/20220622153221109.jpg)

4、以上设置好后就可以在本地物理机访问虚拟机了，如下我们ping 下刚才的192.168.137.200，可见是可以ping得通的，这时就可以使用xshell等终端进行连接操作了：

![](//img.jbzj.com/file_images/article/202206/20220622153221110.jpg)

5、若在虚拟机上有需要访问外网的操作，则在控制面板->网络和共享中心->更改适配器设置中，选中此时物理机使用的网卡，右键属性点击共享选项，如下选中复选框，再选择hyper-v上我们新建的网络，点击确定，这样操作之后我们的虚拟机就可以共享访问到外部的网络了。可通过ping www.baidu.com进行网络测试。在win11中这个internet连接共享我找了好久，在高级网络设置->更改适配器选项

需要注意的是有时选择下面的操作之后，虚拟网络交换机上的IP地址可能会变化，若有变化的话需按上面第3步的操作手工再修改回跟我们centos虚拟机上设置的IP一致的网段。

![](//img.jbzj.com/file_images/article/202206/20220622153221111.jpg)

 到此这篇关于Hyper-V设置虚拟机固定Ip的方法步骤的文章就介绍到这了,更多相关Hyper-V 虚拟机固定Ip内容请搜索脚本之家以前的文章或继续浏览下面的相关文章希望大家以后多多支持脚本之家！